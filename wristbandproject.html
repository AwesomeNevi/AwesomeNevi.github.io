<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="wristband.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/atom-one-dark.min.css">
    <title>Nevi's Projects</title>
</head>
<body>
    <header>
        <a href="index.html" class="back-link">
            <img src="backarrow.png" alt="Back Arrow">
        </a>
        <a href="index.html">
            <img src="nevisprojectslogo.png" alt="Nevi's Projects Logo">
        </a>
    </header>

    <div class="cards-container">
        <div class="card card-image1">
            <img src="wristband1.png" alt="LED Image">
        </div>
        <div class="card card-text1">
            <div class="card-content">
                <h3>Arduino Wristband</h3>
                <p>This design aims to act as a monitering/alert system for patients and the elderly</p>
                <p>It provides heart rate and accelerometer data to detect abnormal heart patterns and falls, and alert caretakers</p>
                <p>Uses HTTP methods (POST requests) to send data to a server for logging and processing</p>
                <p>Processing the bulk of the data on the server helps run the Arduino Pro Mini on low power, this effect is helped by periodic scanning and an interrupt driven system based on the ADXL345</p>
                <p>Working on effective power management helped me explore battery charging circuits, introducing me to overcharge/discharge protection and charging ICs. Eventually I decided to go with the TP4056 module</p>
                <p>Uses an ADS9008 based IR pulse sensor to accurately monitor pulse</p>
                <p>Filtering algorithm helps remove anomalies and provide an accurate curve</p>
            </div>
        </div>
        
    </div>

    <div class="cards-container">
        <div class="card card-image2">
            <img src="heartgraph.png" alt="LED Image">
        </div>
        </div>
                <div class="card card-text2">
            <div class="card-content">
                <h3>Graph</h3>
                <p>Sketch generated by using the filtering algorithm, maps heart rate data onto a standard normal distribution to filter for anomalies</p>
                <p>Smoothing with Averages: 
                <p>On the Arduino side, we're smoothing out the sensor readings by averaging the last 10 readings. This helps to reduce random noise and gives a more stable heart rate value.</p>    
                <p>Normal Distribution Filter:</p>
                <p>In the Processing sketch, we have a basic normal distribution filter. This normalizes the heart rate values by converting them to a standard normal distribution (mean of 0 and standard deviation of 1). More complex filtering techniques like Kalman filters or moving average filters are also useful however are difficult to run on small low power boards.</p>
            </div>
    </div>

    <div class="cards-container">
        <div class="card card-image1">
            <img src="heartsensor,jpg.jpg" alt="LED Image">
        </div>
        <div class="card card-text3">
            <div class="card-content">
                <h3>Sensor Testing</h3>
                <p>Interfaced sensor with arduino with 3v3 analog in and initialized the internal pulldown resistor to take readings from the sensor</p>
                <p>Configured the ADS9008 library for use with the v1.3 version of the sensor and arduino pro mini board</p>
                <p>Also used appropriate libraries to activate a low-power state on the MCU when sensor readings are stale</p>
            </div>
        </div>
        
    </div>

    <div class="card">
        <pre><code class="java">
            import processing.serial.*; // Import the serial library
            import java.util.LinkedList; // Import the LinkedList class
            
            Serial myPort; // The serial port
            LinkedList<Float> rawData = new LinkedList<Float>(); // List to store raw data
            LinkedList<Float> filteredData = new LinkedList<Float>(); // List to store filtered data
            int numDataPoints = 100; // Number of data points to display
            
            void setup() {
              size(800, 400); // Set the size of the window
              String portName = Serial.list()[0]; // Automatically get the first port (modify if necessary)
              myPort = new Serial(this, portName, 9600); // Initialize the serial port
            }
            
            void draw() {
              background(255); // Clear the background with white color
              stroke(0); // Set the stroke color to black
              strokeWeight(2); // Set the stroke weight to 2
            
              // Read data from the serial port
              while (myPort.available() > 0) {
                String inString = myPort.readStringUntil('\n');
                if (inString != null) {
                  float rawValue = float(trim(inString)); // Convert the string to a float
                  rawData.add(rawValue); // Add the raw value to the list
            
                  // Apply a standard normal distribution filter
                  float filteredValue = applyNormalDistributionFilter(rawValue);
                  filteredData.add(filteredValue); // Add the filtered value to the list
            
                  // Keep the lists within the limit
                  if (rawData.size() > numDataPoints) {
                    rawData.removeFirst();
                  }
                  if (filteredData.size() > numDataPoints) {
                    filteredData.removeFirst();
                  }
                }
              }
            
              // Draw the raw data
              stroke(150, 0, 0); // Red color for raw data
              drawData(rawData);
            
              // Draw the filtered data
              stroke(0, 150, 0); // Green color for filtered data
              drawData(filteredData);
            
              // Draw the axes
              drawAxes();
            }
            
            // Function to draw the data
            void drawData(LinkedList<Float> data) {
              for (int i = 1; i < data.size(); i++) {
                float x1 = map(i - 1, 0, numDataPoints - 1, 50, width - 50);
                float y1 = map(data.get(i - 1), 0, 1023, height - 50, 50);
                float x2 = map(i, 0, numDataPoints - 1, 50, width - 50);
                float y2 = map(data.get(i), 0, 1023, height - 50, 50);
                line(x1, y1, x2, y2);
              }
            }
            
            // Function to apply a standard normal distribution filter
            float applyNormalDistributionFilter(float value) {
              // In a real application, you would use more complex filtering
              // Here we simulate a simple normal distribution filter
              float mean = 0;
              float stddev = 1;
              float normalizedValue = (value - mean) / stddev;
              return normalizedValue;
            }
            
            // Function to draw the axes with values
            void drawAxes() {
              strokeWeight(1);
              // X-axis
              line(50, height - 50, width - 50, height - 50);
              // Y-axis
              line(50, height - 50, 50, 50);
            
              // Labels for axes
              fill(0);
              textSize(12);
              textAlign(CENTER, CENTER);
              text("Time (data points)", width / 2, height - 30);
              textAlign(RIGHT, CENTER);
              text("Heart Rate", 40, height / 2);
            
              // Draw X-axis values
              for (int i = 0; i <= numDataPoints; i += 10) {
                int x = int(map(i, 0, numDataPoints, 50, width - 50));
                text(i, x, height - 35);
                line(x, height - 55, x, height - 45);
              }
            
              // Draw Y-axis values
              for (int i = 0; i <= 1023; i += 200) {
                int y = int(map(i, 0, 1023, height - 50, 50));
                text(i, 45, y);
                line(45, y, 55, y);
              }
            }
            
                
</code></pre>
    </div>
    <!-- Include Highlight.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>
